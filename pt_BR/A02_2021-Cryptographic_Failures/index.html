
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="OWASP Top 10:2021">
      
      
      
      
        <link rel="prev" href="../A01_2021-Broken_Access_Control/">
      
      
        <link rel="next" href="../A03_2021-Injection/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>A02 Falhas Criptográficas - OWASP Top 10:2021</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.bcfcd587.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#a022021-falhas-criptograficas" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../" title="OWASP Top 10:2021" class="md-header__button md-logo" aria-label="OWASP Top 10:2021" data-md-component="logo">
      
  <img src="../../assets/OWASP_Logo_Transp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            OWASP Top 10:2021
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              A02 Falhas Criptográficas
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../" hreflang="en" class="md-select__link">
              en - English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../ar/" hreflang="ar" class="md-select__link">
              ar - ﺎﻠﻋﺮﺒﻳﺓ
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../de/" hreflang="de" class="md-select__link">
              de - Deutsch
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../es/" hreflang="es" class="md-select__link">
              es - Español
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../fr/" hreflang="fr" class="md-select__link">
              fr - Français
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../id/" hreflang="id" class="md-select__link">
              id - Indonesian
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../it/" hreflang="it" class="md-select__link">
              it - Italiano
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../ja/" hreflang="ja" class="md-select__link">
              ja - 日本語
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../" hreflang="pt_BR" class="md-select__link">
              pt_BR - Português (Brasil)
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../zh_CN/" hreflang="zh_CN" class="md-select__link">
              zh_CN - 简体中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../zh_TW/" hreflang="zh_TW" class="md-select__link">
              zh_TW - 繁體中文
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/OWASP/Top10" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/Top10
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../" title="OWASP Top 10:2021" class="md-nav__button md-logo" aria-label="OWASP Top 10:2021" data-md-component="logo">
      
  <img src="../../assets/OWASP_Logo_Transp.png" alt="logo">

    </a>
    OWASP Top 10:2021
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/OWASP/Top10" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    OWASP/Top10
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Início
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../0x00-notice/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Notas
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021_Introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introdução
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021_How_to_use_the_OWASP_Top_10_as_a_standard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Como usar o OWASP Top 10 como padrão
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../A00_2021-How_to_start_an_AppSec_program_with_the_OWASP_Top_10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Como iniciar um programa AppSec com o OWASP Top 10
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../A00-about-owasp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sobre OWASP
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Lista top 10:2021
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Lista top 10:2021
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A01_2021-Broken_Access_Control/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A01 Quebra de Controle de Acesso
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    A02 Falhas Criptográficas
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    A02 Falhas Criptográficas
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fatores" class="md-nav__link">
    <span class="md-ellipsis">
      Fatores
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visao-geral" class="md-nav__link">
    <span class="md-ellipsis">
      Visão Geral
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#descricao" class="md-nav__link">
    <span class="md-ellipsis">
      Descrição
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#como-prevenir" class="md-nav__link">
    <span class="md-ellipsis">
      Como Prevenir
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exemplos-de-cenarios-de-ataque" class="md-nav__link">
    <span class="md-ellipsis">
      Exemplos de Cenários de Ataque
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias" class="md-nav__link">
    <span class="md-ellipsis">
      Referências
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lista-dos-cwes-mapeados" class="md-nav__link">
    <span class="md-ellipsis">
      Lista dos CWEs Mapeados
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A03_2021-Injection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A03 Injeção
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A04_2021-Insecure_Design/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A04 Design Inseguro
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A05_2021-Security_Misconfiguration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A05 Configuração Incorreta de Segurança
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A06_2021-Vulnerable_and_Outdated_Components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A06 Componentes Vulneráveis e Desatualizados
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A07_2021-Identification_and_Authentication_Failures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A07 Falhas de identificação e autenticação
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A08_2021-Software_and_Data_Integrity_Failures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A08 Falhas de Software e Integridade de Dados
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A09_2021-Security_Logging_and_Monitoring_Failures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A09 Falhas de registro e monitoramento de segurança
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../A10_2021-Server-Side_Request_Forgery_%28SSRF%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A10 Falsificação de Solicitação do Lado do Servidor (SSRF)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../A11_2021-Next_Steps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Próximos passos
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fatores" class="md-nav__link">
    <span class="md-ellipsis">
      Fatores
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#visao-geral" class="md-nav__link">
    <span class="md-ellipsis">
      Visão Geral
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#descricao" class="md-nav__link">
    <span class="md-ellipsis">
      Descrição
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#como-prevenir" class="md-nav__link">
    <span class="md-ellipsis">
      Como Prevenir
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#exemplos-de-cenarios-de-ataque" class="md-nav__link">
    <span class="md-ellipsis">
      Exemplos de Cenários de Ataque
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#referencias" class="md-nav__link">
    <span class="md-ellipsis">
      Referências
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lista-dos-cwes-mapeados" class="md-nav__link">
    <span class="md-ellipsis">
      Lista dos CWEs Mapeados
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="a022021-falhas-criptograficas">A02:2021 – Falhas Criptográficas    <img align="right" alt="icon" src="../assets/TOP_10_Icons_Final_Crypto_Failures.png" style="height:80px;width:80px" /></h1>
<h2 id="fatores">Fatores</h2>
<table>
<thead>
<tr>
<th style="text-align: center;">CWEs Mapeados</th>
<th style="text-align: center;">Taxa de Incidência Máxima</th>
<th style="text-align: center;">Taxa de Incidência Média</th>
<th style="text-align: center;">Exploração Média Ponderada</th>
<th style="text-align: center;">Impacto Médio Ponderado</th>
<th style="text-align: center;">Cobertura Máxima</th>
<th style="text-align: center;">Cobertura Média</th>
<th style="text-align: center;">Total de ocorrências</th>
<th style="text-align: center;">Total de CVEs</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">29</td>
<td style="text-align: center;">46.44%</td>
<td style="text-align: center;">4.49%</td>
<td style="text-align: center;">7.29</td>
<td style="text-align: center;">6.81</td>
<td style="text-align: center;">79.33%</td>
<td style="text-align: center;">34.85%</td>
<td style="text-align: center;">233,788</td>
<td style="text-align: center;">3,075</td>
</tr>
</tbody>
</table>
<h2 id="visao-geral">Visão Geral</h2>
<p>Subindo uma posição para #2, anteriormente conhecido como <em>Exposição de Dados
Sensíveis</em>, que é mais um sintoma amplo do que uma causa raiz,
o foco está nas falhas relacionadas à criptografia (ou falta dela).
O que muitas vezes leva à exposição de dados confidenciais. Notável <em>Common Weakness
Enumerations</em> (CWEs) incluídas são <em>CWE-259: Uso de Senha no Código</em>,
<em>CWE-327: Algoritmo Criptográfico Quebrado ou Arriscado</em> e <em>CWE-331 Entropia Insuficiente</em>.</p>
<h2 id="descricao">Descrição</h2>
<p>A primeira coisa é determinar as necessidades de proteção dos dados
em trânsito e armazenados. Por exemplo, senhas, número de cartão de crédito,
registros de saúde, informações pessoas e segredos de negócios que requerem
proteção extra, principalmente se esses dados se enquadrarem nas leis de
privacidade, alguns exemplos são a da Europa General Data Protection Regulation
(GDPR) ou regulamentos de proteção de dados financeiros, como PCI Data Security
Standard (PCI DSS). Para todos esses dados:</p>
<ul>
<li>
<p>Todos os dados são transmitidos em texto não criptografado? Isso diz respeito a
    protocolos como HTTP, SMTP, FTP também usando atualizações TLS como STARTTLS.
    O tráfego externo da Internet é perigoso. Verifique todo o tráfego interno,
    por exemplo, entre balanceadores de carga, servidores da web ou sistemas <em>back-end</em>.</p>
</li>
<li>
<p>Algum algoritmo ou protocolo criptográfico antigo ou fraco é usado por padrão ou
    em código mais antigo?</p>
</li>
<li>
<p>As chaves criptográficas padrão em uso, são chaves criptográficas geradas fracas
    ou reutilizadas, faltando o gerenciamento ou rotação de chaves adequado?
    As chaves criptográficas são verificadas nos repositórios de código-fonte?</p>
</li>
<li>
<p>A criptografia não é aplicada, por exemplo, há alguma diretiva de segurança
    de cabeçalhos HTTP (navegador) ou cabeçalhos ausentes?</p>
</li>
<li>
<p>O certificado do servidor recebido e a cadeia de confiança estão devidamente validados? </p>
</li>
<li>
<p>Os vetores de inicialização são ignorados, reutilizados ou não gerados
    suficientemente seguros para o modo criptográfico de operação? Está em uso um modo
    de operação inseguro, como o ECB? A criptografia é usada quando a criptografia
    autenticada é a mais apropriada?</p>
</li>
<li>
<p>As senhas estão sendo usadas como chaves criptográficas na ausência de uma função
    de derivação de chave de base de senha?</p>
</li>
<li>
<p>A aleatoriedade é usada para fins criptográficos que não foram projetados para atender
    aos requisitos criptográficos? Mesmo se a função correta for escolhida, ela precisa
    ser propagada pelo desenvolvedor e, se não, o desenvolvedor sobrescreveu a forte
    funcionalidade de propagação incorporada a ela com uma semente que carece de
    entropia/imprevisibilidade suficiente?</p>
</li>
<li>
<p>Estão em uso funções hash obsoletas, como MD5 ou SHA1, ou funções hash não criptográficas
    usadas quando funções hash criptográficas são necessárias?</p>
</li>
<li>
<p>Estão em uso métodos de preenchimento criptográfico obsoletos, como PKCS número 1 v1.5?</p>
</li>
<li>
<p>As mensagens de erro criptográficas ou as informações do canal lateral podem ser exploradas,
    por exemplo, na forma de ataques oracle de preenchimento?</p>
</li>
</ul>
<p>Consulte ASVS Crypto (V7), Data Protection (V9) e SSL/TLS (V10)</p>
<h2 id="como-prevenir">Como Prevenir</h2>
<p>Faça o seguinte, no mínimo, e consulte as referências:</p>
<ul>
<li>
<p>Classifique os dados processados, armazenados ou transmitidos por um aplicativo.
    Identifique quais dados são confidenciais de acordo com as leis de privacidade, requisitos
    regulamentares ou necessidades de negócios.</p>
</li>
<li>
<p>Não armazene dados confidenciais desnecessariamente. Descarte-o o mais rápido possível ou use
    tokenização compatível com PCI DSS ou mesmo truncamento. Os dados não retidos não podem ser roubados.</p>
</li>
<li>
<p>Certifique-se de criptografar todos os dados confidenciais armazenados.</p>
</li>
<li>
<p>Certifique-se de que algoritmos, protocolos e senhas de padrão forte e atualizados estejam
    em vigor; use o gerenciamento de senhas adequado.</p>
</li>
<li>
<p>Criptografe todos os dados em trânsito com protocolos seguros, como TLS com cifras de sigilo
    de encaminhamento (FS), priorização de cifras pelo servidor e parâmetros seguros. Aplique
    a criptografia usando diretivas como HTTP Strict Transport Security (HSTS).</p>
</li>
<li>
<p>Desative o armazenamento em cache para respostas que contenham dados confidenciais.</p>
</li>
<li>
<p>Aplique os controles de segurança necessários de acordo com a classificação de dados.</p>
</li>
<li>
<p>Não use protocolos legados, como FTP e SMTP, para transportar dados confidenciais.</p>
</li>
<li>
<p>Armazene senhas usando fortes funções de hash adaptáveis e saltadas com um fator de
    trabalho (fator de atraso), como Argon2, scrypt, bcrypt ou PBKDF2.</p>
</li>
<li>
<p>Os vetores de inicialização devem ser escolhidos de acordo com o modo de
    operação. Para muitos modos, isso significa usar um CSPRNG (gerador de
    números pseudo-aleatórios criptograficamente seguro). Para modos que requerem
    um nonce, o vetor de inicialização (IV) não precisa de um CSPRNG. Em todos os
    casos, o IV nunca deve ser usado duas vezes para uma chave fixa.</p>
</li>
<li>
<p>Sempre use criptografia autenticada em vez de apenas criptografia.</p>
</li>
<li>
<p>As chaves devem ser geradas de forma criptograficamente aleatória e armazenadas
    na memória como um <em>array</em> de <em>bytes</em>. Se uma senha for usada, ela deve ser
    convertida em uma chave por meio de uma função de derivação de chave de
    base de senha apropriada.</p>
</li>
<li>
<p>Certifique-se de que a aleatoriedade criptográfica seja usada quando apropriado
    e que não tenha sido usada uma semente de uma forma previsível ou com baixa entropia.
    A maioria das APIs modernas não exige que o desenvolvedor propague o CSPRNG para obter segurança.</p>
</li>
<li>
<p>Evite funções criptográficas e esquemas de preenchimento obsoletos, como MD5, SHA1, PKCS número 1 v1.5.</p>
</li>
<li>
<p>Verifique de forma independente a eficácia das configurações.</p>
</li>
</ul>
<h2 id="exemplos-de-cenarios-de-ataque">Exemplos de Cenários de Ataque</h2>
<p><strong>Cenário #1</strong>: Um aplicativo criptografa números de cartão de crédito
em um banco de dados usando criptografia automática de banco de dados.
No entanto, esses dados são automaticamente descriptografados quando
recuperados, permitindo que uma falha de injeção de SQL recupere
números de cartão de crédito em texto não criptografado.</p>
<p><strong>Cenário #2</strong>: Um site não usa ou impõe TLS para todas as páginas
ou oferece suporte a criptografia fraca. Um invasor monitora o tráfego
de rede (por exemplo, em uma rede sem fio insegura), faz o downgrade
de conexões de HTTPS para HTTP, intercepta solicitações e rouba o cookie
de sessão do usuário. O invasor então reproduz esse cookie e sequestra
a sessão (autenticada) do usuário, acessando ou modificando os dados
privados do usuário. Em vez do acima, eles podem alterar todos os dados
transportados, por exemplo, o destinatário de uma transferência de dinheiro.</p>
<p><strong>Cenário #3</strong>: O banco de dados de senha usa hashes sem saltos ou simples
para armazenar as senhas de todos. Uma falha de <em>upload</em> de arquivo permite
que um invasor recupere o banco de dados de senhas. Todos os hashes sem saltos
podem ser expostos com uma <em>rainbow table</em> de hashes pré-calculados. Hashes
geradas por funções de hash simples ou rápidas podem ser quebrados por GPUs,
mesmo se forem saltadas.</p>
<h2 id="referencias">Referências</h2>
<ul>
<li>
<p><a href="https://owasp.org/www-project-proactive-controls/v3/en/c8-protect-data-everywhere">OWASP Proactive Controls: Protect Data
    Everywhere</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-application-security-verification-standard">OWASP Application Security Verification Standard (V7,
    9, 10)</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Transport_Layer_Protection_Cheat_Sheet.html">OWASP Cheat Sheet: Transport Layer
    Protection</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/User_Privacy_Protection_Cheat_Sheet.html">OWASP Cheat Sheet: User Privacy
    Protection</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html">OWASP Cheat Sheet: Password and Cryptographic Storage</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html">OWASP Cheat Sheet:
    HSTS</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/09-Testing_for_Weak_Cryptography/README">OWASP Testing Guide: Testing for weak cryptography</a></p>
</li>
</ul>
<h2 id="lista-dos-cwes-mapeados">Lista dos CWEs Mapeados</h2>
<p><a href="https://cwe.mitre.org/data/definitions/261.html">CWE-261 Weak Encoding for Password</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/296.html">CWE-296 Improper Following of a Certificate's Chain of Trust</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/310.html">CWE-310 Cryptographic Issues</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/319.html">CWE-319 Cleartext Transmission of Sensitive Information</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/321.html">CWE-321 Use of Hard-coded Cryptographic Key</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/322.html">CWE-322 Key Exchange without Entity Authentication</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/323.html">CWE-323 Reusing a Nonce, Key Pair in Encryption</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/324.html">CWE-324 Use of a Key Past its Expiration Date</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/325.html">CWE-325 Missing Required Cryptographic Step</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/326.html">CWE-326 Inadequate Encryption Strength</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/327.html">CWE-327 Use of a Broken or Risky Cryptographic Algorithm</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/328.html">CWE-328 Reversible One-Way Hash</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/329.html">CWE-329 Not Using a Random IV with CBC Mode</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/330.html">CWE-330 Use of Insufficiently Random Values</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/331.html">CWE-331 Insufficient Entropy</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/335.html">CWE-335 Incorrect Usage of Seeds in Pseudo-Random Number Generator(PRNG)</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/336.html">CWE-336 Same Seed in Pseudo-Random Number Generator (PRNG)</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/337.html">CWE-337 Predictable Seed in Pseudo-Random Number Generator (PRNG)</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/338.html">CWE-338 Use of Cryptographically Weak Pseudo-Random Number Generator(PRNG)</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/340.html">CWE-340 Generation of Predictable Numbers or Identifiers</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/347.html">CWE-347 Improper Verification of Cryptographic Signature</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/523.html">CWE-523 Unprotected Transport of Credentials</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/720.html">CWE-720 OWASP Top Ten 2007 Category A9 - Insecure Communications</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/757.html">CWE-757 Selection of Less-Secure Algorithm During Negotiation('Algorithm Downgrade')</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/759.html">CWE-759 Use of a One-Way Hash without a Salt</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/760.html">CWE-760 Use of a One-Way Hash with a Predictable Salt</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/780.html">CWE-780 Use of RSA Algorithm without OAEP</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/818.html">CWE-818 Insufficient Transport Layer Protection</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/916.html">CWE-916 Use of Password Hash With Insufficient Computational Effort</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © Copyright 2021 - OWASP Top 10 team - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>