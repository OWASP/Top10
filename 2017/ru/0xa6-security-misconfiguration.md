# A6:2017 Некорректная настройка параметров безопасности

| Источники угроз/Векторы атак | Недостатки безопасности           | Последствия               |
| -- | -- | -- |
| Зависит от прил. : Сложность эксплуатации 3 | Распространенность 3 : Сложность обнаружения 3 | Технические 2 : Для бизнеса ? |
| Злоумышленники часто пытаются эксплуатировать неисправленные уязвимости, настроенные по умолчанию учетные записи, неиспользуемые страницы, незащищенные файлы и каталоги для получения несанкционированного доступа или информации о системе. | Настройка безопасности может быть выполнена некорректно на любом уровне приложения, включая сетевые службы, платформы, веб-службы, сервер, базу данных, фреймворки, код, а также предустановленные виртуальные машины, контейнеры или хранилища. Для поиска уязвимых настроек, настроенных по умолчанию учетных записей, неиспользуемых служб, устаревших параметров и т. п. можно использовать автоматизированные сканеры. | SПодобные уязвимости позволяют злоумышленникам получить несанкционированный доступ к системным данным или функциям, а также могут привести к полной компрометации системы. Последствия для бизнеса зависят от критичности защиты приложения и данных. |

## Является ли приложение уязвимым?

Приложение уязвимо, если:

* любой из компонентов приложения недостаточно защищен или разрешения облачных сервисов некорректно настроены;
* включены или присутствуют лишние функции (например, неиспользуемые порты, службы, страницы, учетные записи или привилегии);
* учетные записи и пароли, создаваемые по умолчанию, используются без изменений;
* обработка ошибок позволяет осуществить трассировку стека или получить слишком подробные сообщения об ошибках;
* отключены или некорректно настроены последние обновления безопасности;
* не выбраны безопасные значения параметров защиты серверов приложений, фреймворков (например, Struts, Spring, ASP.NET), библиотек и т. п.;
* сервер не использует безопасные заголовки или директивы, а также если они некорректно настроены;
* ПО устарело или имеет уязвимости (см. __A9:2017-Использование компонентов с известными уязвимостями__).

Без организованной и регулярно выполняемой проверки безопасности приложений системы подвержены большему риску.

## Как предотвратить

Необходимо реализовать процесс безопасной установки, включая:

* воспроизводимость процессов для быстрого создания сред с ограниченной функциональностью. Среды для разработки, контроля качества и производства должны быть настроены одинаково, но иметь разные учетные данные. Процессы должны быть автоматизированы для минимизации затрат на создание новых безопасных сред;
* использование платформ только с необходимым набором функций, компонентов, документации и образцов. Удалите или не устанавливайте лишние компоненты или фреймворки;
* проверку и актуализацию параметров настройки безопасности в соответствии с выпускаемыми бюллетенями, обновлениями и исправлениями (см. __A9:2017-Использование компонентов с известными уязвимостями__), а также проверку разрешений облачных хранилищ (например, для контейнеров S3);
* создание сегментированной архитектуры приложения, обеспечивающей эффективное разграничение компонентов или клиентов с помощью контейнеризации или облачных групп безопасности (списков контроля доступа);
* использование безопасных директив для клиентов, например, [безопасных заголовков](https://www.owasp.org/index.php/OWASP_Secure_Headers_Project); 
* автоматизацию проверки эффективности используемых конфигураций и настроек во всех средах.

## Примеры сценариев атак

**Сценарий №1**: Сервер приложений поставляется с образцами приложений, которые не удаляются с рабочего сервера. Эти приложения содержат известные уязвимости, позволяющие злоумышленникам скомпрометировать сервер. Если одно из этих приложений является консолью администратора, а стандартные учетные записи не менялись, то атакующий может войти в приложение и перехватить контроль над ним, используя стандартный пароль.

**Сценарий №2**: На сервере не отключен вывод списка файлов в каталогах, что позволяет злоумышленнику найти и выгрузить скомпилированные Java-классы, после декомпиляции и обратного анализа которых можно просмотреть исходный код. В результате атакующий может обнаружить уязвимости и получить доступ к приложению.

**Сценарий №3**: Сервер приложений настроен на отправку подробных сообщений об ошибках, включая данные о трассировке стека. Это может привести к разглашению важной информации, например, о версии компонента, содержащей известные уязвимости.

**Сценарий №4**: Поставщик облачных услуг использует стандартные разрешения общего доступа через интернет для других пользователей облака. Это позволяет получить доступ к конфиденциальной информации, доступной в облачном хранилище.

## Ссылки

### OWASP

* [Руководство OWASP по тестированию: Управление конфигурацией](https://www.owasp.org/index.php/Testing_for_configuration_management)
* [Руководство OWASP по тестированию: Коды ошибок](https://www.owasp.org/index.php/Testing_for_Error_Code_(OWASP-IG-006))
* [Проект OWASP: Безопасные заголовки](https://www.owasp.org/index.php/OWASP_Secure_Headers_Project)

Для получения дополнительной информации по данной теме см. "Стандарт подтверждения безопасности приложений (ASVS): [V19 Конфигурация](https://www.owasp.org/index.php/ASVS_V19_Configuration)".

### Сторонние

* [Руководство NIST по повышению безопасности серверов](https://csrc.nist.gov/publications/detail/sp/800-123/final)
* [CWE-2: Уязвимости, связанные со средой](https://cwe.mitre.org/data/definitions/2.html)
* [CWE-16: Уязвимости, связанные с конфигурацией](https://cwe.mitre.org/data/definitions/16.html)
* [CWE-388: Уязвимости, связанные с обработкой ошибок](https://cwe.mitre.org/data/definitions/388.html)
* [Руководства/стандарты CIS по настройке безопасности](https://www.cisecurity.org/cis-benchmarks/)
* [Обнаружение и перечисление контейнеров Amazon S3](https://blog.websecurify.com/2017/10/aws-s3-bucket-discovery.html)
