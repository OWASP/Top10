# A9:2017 Использование компонентов с известными уязвимостями

| Источники угроз/Векторы атак | Недостатки безопасности           | Последствия               |
| -- | -- | -- |
| Зависит от прил. : Сложность эксплуатации 2 | Распространенность 3 : Сложность обнаружения 2 | Технические 2 : Для бизнеса ? |
| Несмотря на простоту поиска уже готовых эксплойтов для большинства известных уязвимостей, некоторые из них требуют создания специальных средств для их эксплуатации. | Данная уязвимость является очень распространенной. Шаблоны для разработчиков, содержащие большое количество компонентов, могут привести к непониманию того, какие компоненты  реально используются в приложении или API. Некоторые сканеры, такие как retire.js, могут помочь с обнаружением уязвимостей, но определение сложности их эксплуатации потребует дополнительных усилий.| Несмотря на то, что не все уязвимости приводят к серьезным последствиям, причиной некоторых масштабных взломов стали именно компоненты, содержащие известные уязвимости. В зависимости от защищаемых активов подобная угроза может оказаться на вершине вашего списка. |

## Является ли приложение уязвимым?

Приложение уязвимо, если:

* вы не знаете версии всех используемых (на стороне клиента и на стороне сервера) компонентов. Сюда относятся сами компоненты и встроенные зависимости;
* ПО содержит уязвимости, не поддерживается или устарело. Сюда относятся ОС, веб-серверы, серверы приложений, СУБД, приложения, API, а также все компоненты, среды исполнения и библиотеки;
* поиск уязвимостей выполняется нерегулярно, а также отсутствует подписка на бюллетени по безопасности используемых компонентов;
* своевременно не устанавливаются исправления или обновления для используемых платформ, фреймворков и зависимостей. Обычно такое происходит, когда наличие обновлений проверяется раз в месяц или квартал, в результате чего организации неделями или месяцами не устраняют исправленные уязвимости;
* разработчики ПО не тестируют совместимость обновленных или исправленных библиотек;
* не обеспечивается безопасность компонентов (см. [A6:2017-Некорректные параметры безопасности](0xa6-security-misconfiguration.md)).

## Как предотвратить

Необходимо реализовать процесс управления обновлениями:

* удалите неиспользуемые зависимости, а также лишние функции, компоненты, файлы и сведения из документации;
* регулярно проверяйте актуальность версий клиентских и серверных компонентов (например, фреймворков и библиотек), а также их зависимостей, используя такие инструменты, как [versions](http://www.mojohaus.org/versions-maven-plugin/), [DependencyCheck](https://owasp.org/www-project-dependency-check/), [retire.js](https://github.com/retirejs/retire.js/). Следите за новостями об уязвимостях на соответствующих ресурсах, таких как [CVE](https://cve.mitre.org/) и [NVD](https://nvd.nist.gov/). Используйте инструменты анализа состава ПО для автоматизации процесса. Подпишитесь на рассылки об уязвимостях, относящихся к используемым вами компонентам;
* загружайте компоненты из официальных источников по безопасным ссылкам. Отдавайте предпочтение подписанным пакетам для снижения риска установки измененного или вредоносного компонента;
* следите за библиотеками и компонентами, которые не поддерживаются или не получают обновлений безопасности. Если обновление невозможно, попробуйте использовать [виртуальные патчи](https://owasp.org/www-community/Virtual_Patching_Best_Practices#What_is_a_Virtual_Patch.3F) для обнаружения или предотвращения эксплуатации известных уязвимостей.

Каждая организация должна обеспечить отслеживание, приоритизацию и применение обновлений или изменений в конфигурации на протяжении всего жизненного цикла приложения или линейки приложений.

## Примеры сценариев атак

**Сценарий №1**: Компоненты обычно запускаются с привилегиями приложения, поэтому уязвимость в любом из компонентов может привести к серьезным последствиям. Уязвимость может появиться случайно (например, из-за ошибки в коде) или преднамеренно (например, бэкдор). Вот несколько примеров эксплуатации уязвимостей, обнаруженных в компонентах:

* [CVE-2017-5638](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5638): уязвимость в Struts 2, позволяющая удаленно выполнить произвольный код на сервере, стала причиной нескольких серьезных взломов;
* уязвимости в [интернете вещей (IoT)](https://en.wikipedia.org/wiki/Internet_of_things) зачастую сложно или невозможно устранить, а это может привести к серьезным последствиям (например, в случае биомедицинских приборов).

Существуют автоматизированные инструменты, позволяющие злоумышленникам находить уязвимые или некорректно настроенные системы. Например, поисковик [Shodan для IoT](https://www.shodan.io/) позволяет обнаружить устройства, в которых до сих пор не устранена уязвимость [Heartbleed](https://en.wikipedia.org/wiki/Heartbleed), которая была исправлена в апреле 2014 года.

## Ссылки

### OWASP

* [Стандарт подтверждения безопасности приложений OWASP: V1 Архитектура, разработка и моделирование угроз](https://github.com/OWASP/ASVS/blob/v4.0.2/4.0/en/0x10-V1-Architecture.md)
* [Проверки зависимостей OWASP (для библиотек Java и .NET)](https://owasp.org/www-project-dependency-check/)
* [Руководство OWASP по тестированию: Установление взаимосвязей в архитектуре приложения (OTG-INFO-010)](https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/01-Information_Gathering/10-Map_Application_Architecture)
* [Рекомендации OWASP по использованию виртуальных патчей](https://owasp.org/www-community/Virtual_Patching_Best_Practices)

### Сторонние

* [Унылая реальность небезопасных библиотек](https://cdn2.hubspot.net/hub/203759/file-1100864196-pdf/docs/Contrast_-_Insecure_Libraries_2014.pdf)
* [Поиск уязвимостей (CVE) MITRE](https://www.cvedetails.com/version-search.php)
* [Национальная база данных уязвимостей (NVD)](https://nvd.nist.gov/)
* [Retire.js для обнаружения известных уязвимых библиотек JavaScript](https://github.com/retirejs/retire.js/)
* [Бюллетени по безопасности библиотек Node](https://nodesecurity.io/advisories)
* [Инструменты и база данных бюллетеней по безопасности библиотек Ruby](https://rubysec.com/)